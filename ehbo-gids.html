<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>EHBO Gids - Noodhulp App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>
<body class="guide-page">

<nav class="top-nav">
    <div class="nav-left">
        <select id="languageSelect" class="btn-lang" onchange="changeLanguage(this.value)">
            <option value="nl">ğŸ‡³ğŸ‡±</option>
            <option value="en">ğŸ‡¬ğŸ‡§</option>
            <option value="de">ğŸ‡©ğŸ‡ª</option>
            <option value="fr">ğŸ‡«ğŸ‡·</option>
            <option value="es">ğŸ‡ªğŸ‡¸</option>
        </select>
        <a href="quiz.html" class="btn-top btn-trainen" data-i18n="train">Trainen</a>
    </div>
    <img src="images/logo.png" alt="Noodhulp App Logo" class="app-logo">
    <div class="nav-right">
        <a href="tel:112" class="btn-top btn-112" data-i18n="call112">ğŸ“ 112</a>
        <button class="info-btn" onclick="showInfo()" data-i18n="info">â„¹ï¸</button>
    </div>
</nav>

<main class="main-content">
    <div class="search-container">
        <input type="text" placeholder="Wat is er aan de hand? (bijv. 'brandwond')" class="search-bar" data-i18n="search_placeholder">
    </div>

    <section class="guide-grid">
        <div class="guide-card urgent" onclick="toggleDetails('cpr')">
            <div class="card-header">
                <span class="guide-icon">ğŸ«€</span>
                <h3>Reanimatie & AED</h3>
            </div>
            <div id="cpr" class="guide-details">
                <p><strong>1. Controleer bewustzijn:</strong> Schud aan schouders, roep luid.</p>
                <p><strong>2. Ademhaling:</strong> Kijk, luister, voel (max 10 sec).</p>
                <p><strong>3. Bel 112:</strong> Zet de telefoon op de luidspreker.</p>
                
                <p><strong>4. Borstcompressies:</strong> 30 keer in hoog tempo (100-120 bpm).</p>
                <p><strong>5. Beademing:</strong> 2 keer kort blazen (indien getraind).</p>
                <p><em>Tip:</em> wissel om de twee minuten van hulpverlener om vermoeidheid te voorkomen.</p>
                <p>
                    <button onclick="document.getElementById('cpr-audio').play();">Speel hartslagâ€‘ritme</button>
                </p>
                <audio id="cpr-audio" src="hartslag.mp3" preload="auto"></audio>
            </div>
        </div>

        <div class="guide-card" onclick="toggleDetails('choking')">
            <div class="card-header">
                <span class="guide-icon">ğŸ¥¨</span>
                <h3>Verslikking</h3>
            </div>
            <div id="choking" class="guide-details">
                <p><strong>1. Moedig aan tot hoesten.</strong></p>
                <p><strong>2. 5 slagen tussen schouderbladen:</strong> Sla met de hiel van je hand.</p>
                

[Image of the Heimlich maneuver steps]

                <p><strong>3. Heimlich greep:</strong> 5 keer krachtig trekken boven de navel.</p>
                <p><em>Tip:</em> bij kinderen gebruik minder kracht en controleer na elke poging of het voorwerp is losgeraakt.</p>
            </div>
        </div>

        <div class="guide-card" onclick="toggleDetails('unconscious')">
            <div class="card-header">
                <span class="guide-icon">ğŸ˜´</span>
                <h3>Bewusteloosheid</h3>
            </div>
            <div id="unconscious" class="guide-details">
                <p>Ademt het slachtoffer nog wel? Leg deze in de <strong>Stabiele Zijligging</strong>.</p>
                

[Image of the recovery position]

                <p>Controleer elke minuut de ademhaling tot de ambulance er is.</p>
                <p><em>Tip:</em> praat rustig tegen het slachtoffer, soms helpt contact om bewustzijn terug te winnen.</p>
            </div>
        </div>

        <div class="guide-card" onclick="toggleDetails('burns')">
            <div class="card-header">
                <span class="guide-icon">ğŸ”¥</span>
                <h3>Brandwonden</h3>
            </div>
            <div id="burns" class="guide-details">
                <p><strong>Eerst water, de rest komt later.</strong></p>
                <p>Minimaal 10-20 minuten koelen met lauw, zacht stromend kraanwater.</p>
                <p>Verwijder kleding alleen als deze niet aan de wond kleeft.</p>
                <p><em>Tip:</em> overleg bij twijfel met de huisarts of 112 bij zeer grote/verbrande gebieden.</p>
            </div>
        </div>

        <div class="guide-card" onclick="toggleDetails('bleeding')">
            <div class="card-header">
                <span class="guide-icon">ğŸ©¸</span>
                <h3>Bloeding stoppen</h3>
            </div>
            <div id="bleeding" class="guide-details">
                <p><strong>1. Druk uitoefenen:</strong> Gebruik een schone doek en druk stevig op de wond.</p>
                <p><strong>2. Elevatie:</strong> Til het getroffen gebied op boven het hart.</p>
                <p><strong>3. Vervang verband:</strong> Blijf druk uitoefenen; vervang het natte verband niet.</p>
                <p><strong>4. 112 bellen:</strong> Als de bloeding niet stopt of bij grote wonden.</p>
                <p><em>Tip:</em> probeer niet teveel te bewegen, daalt de bloeddruk kan het bloedverlies verminderen.</p>
            </div>
        </div>

        <div class="guide-card" onclick="toggleDetails('poison')">
            <div class="card-header">
                <span class="guide-icon">â˜ ï¸</span>
                <h3>Vergiftiging</h3>
            </div>
            <div id="poison" class="guide-details">
                <p><strong>1. Identificeer de bron:</strong> Wat is ingenomen of ingeademd?</p>
                <p><strong>2. Bel het antigifcentrum:</strong> 030-274 8888 in Nederland.</p>
                <p><strong>3. Houd slachtoffer rustig:</strong> geen braken opwekken zonder advies.</p>
                <p><em>Tip:</em> neem verpakking of label mee naar de telefoon voor het antigifcentrum.</p>                <p>Volg exact de instructies van het antigifcentrum en noem de hoeveelheid en tijd van inname.</p>
            </div>
        </div>

        <!-- extra onderwerpen -->
        <div class="guide-card" onclick="toggleDetails('shock')">
            <div class="card-header">
                <span class="guide-icon">ğŸ˜¨</span>
                <h3>Shock</h3>
            </div>
            <div id="shock" class="guide-details">
                <p><strong>1. Leg het slachtoffer plat</strong> en til benen op (indien geen rug/nekletsel).</p>
                <p><strong>2. Houd warm:</strong> dek af met deken, verwijder strakke kleding.</p>
                <p><strong>3. Geef geen drinken:</strong> kan misselijkheid veroorzaken.</p>
                <p><em>Tip:</em> blijf kalm; noteer eventuele bloedingen of verwondingen voor hulpdiensten.</p>
            </div>
        </div>

        <div class="guide-card" onclick="toggleDetails('fracture')">
            <div class="card-header">
                <span class="guide-icon">ğŸ¦´</span>
                <h3>Botbreuk</h3>
            </div>
            <div id="fracture" class="guide-details">
                <p><strong>1. Immobiliseer:</strong> gebruik spalk of zachte ondersteuning tegen beweging.</p>
                <p><strong>2. Vermijd druk:</strong> raak het gebroken gebied niet onnodig aan.</p>
                <p><strong>3. Koelen:</strong> apply ijskompres met doek om zwelling te verminderen.</p>
                <p><em>Tip:</em> bel 112 bij afwijkende stand of niet beloopbare persoon.</p>
            </div>
        </div>

        <div class="guide-card" onclick="toggleDetails('hypothermia')">
            <div class="card-header">
                <span class="guide-icon">â„ï¸</span>
                <h3>Hypothermie</h3>
            </div>
            <div id="hypothermia" class="guide-details">
                <p><strong>1. Breng binnen:</strong> naar warme plaats of beschutting.</p>
                <p><strong>2. Verwarm geleidelijk:</strong> met dekens, verwarmingen, warm drinken (als bij bewustzijn).</p>
                <p><strong>3. Bel 112:</strong> als alleen trillingen groter zijn of bewustzijn daalt.</p>
                <p><em>Tip:</em> schud niet; kan hartproblemen veroorzaken.</p>
            </div>
        </div>

        <div class="guide-card" onclick="toggleDetails('heatstroke')">
            <div class="card-header">
                <span class="guide-icon">â˜€ï¸</span>
                <h3>Hitteberoerte</h3>
            </div>
            <div id="heatstroke" class="guide-details">
                <p><strong>1. Verplaats naar schaduw:</strong> koel lichaam af met water en ventilator.</p>
                <p><strong>2. Koolhydraten & vocht:</strong> indien bij bewustzijn, geef water met zout en suiker.</p>
                <p><strong>3. 112 bellen:</strong> als koorts >40Â°C of verlies bewustzijn.</p>
                <p><em>Tip:</em> geen alcohol; kan uitdroging verergeren.</p>
            </div>
        </div>

        <div class="guide-card urgent" onclick="toggleDetails('allergy')">
            <div class="card-header">
                <span class="guide-icon">ğŸ¤§</span>
                <h3>Allergische reactie</h3>
            </div>
            <div id="allergy" class="guide-details">
                <p><strong>1. Epinefrine:</strong> indien beschikbaar, spuit met EpiPen in de buitenkant van de dij.</p>
                <p><strong>2. Bel 112 direct:</strong> zelfs als symptoom tijdelijk vermindert.</p>
                <p><strong>3. Laat liggen met benen omhoog:</strong> vermijd staan/buigen.</p>
                <p><em>Tip:</em> verwijder allergenen zoals bijen- of voedselresten uit mond/vel.</p>            </div>
        </div>

        <div class="guide-card" onclick="toggleDetails('water')">
            <div class="card-header">
                <span class="guide-icon">ğŸŒŠ</span>
                <h3>Uit het water</h3>
            </div>
            <div id="water" class="guide-details">
                <p><strong>1. Veiligheid eerst:</strong> breng uzelf niet in gevaar bij het slachtoffer halen.</p>
                <p><strong>2. Controleer ademhaling:</strong> geen adem? start direct met reanimatie volgens de stappen.</p>
                <p><strong>3. Warm houden:</strong> verwijder natte kleren en dek af met droge kleding of deken.</p>
                <p><strong>4. Bel 112:</strong> medische hulp is nodig, ook bij schijnbaar normaal ademhalen.</p>
                <p><em>Tip:</em> geef geen warme dranken; laat ambulancepersoneel onderkoeling behandelen.</p>
            </div>
        </div>
        <!-- additional topics added -->
        <div class="guide-card" onclick="toggleDetails('stroke')">
            <div class="card-header">
                <span class="guide-icon">ğŸ§ </span>
                <h3>Beroerte (FAST)</h3>
            </div>
            <div id="stroke" class="guide-details">
                <p><strong>1.</strong> Herken symptomen: scheve mond, verwarde spraak of krachtverlies in Ã©Ã©n arm (FAST).</p>
                <p><strong>2.</strong> Bel direct 112 en geef de symptomen door; noteer de tijd van de eerste klachten.</p>
                <p><strong>3.</strong> Leg het slachtoffer rustig neer met het hoofd licht omhoog; steun hoofd en nek en blijf bij hem tot de hulp arriveert.</p>
            </div>
        </div>
        <div class="guide-card" onclick="toggleDetails('chestpain')">
            <div class="card-header">
                <span class="guide-icon">ğŸ’”</span>
                <h3>Pijn op de borst</h3>
            </div>
            <div id="chestpain" class="guide-details">
                <p><strong>1.</strong> Realiseer dat ernstige pijn op de borst een hartinfarct kan zijn.</p>
                <p><strong>2.</strong> Laat het slachtoffer rustig zitten of liggen met het bovenlichaam iets omhoog; beweging vermijden.</p>
                <p><strong>3.</strong> Bel 112 en volg de instructies van de alarmcentrale totdat de ambulance arriveert.</p>
            </div>
        </div>
        <div class="guide-card" onclick="toggleDetails('seizure')">
            <div class="card-header">
                <span class="guide-icon">âš¡</span>
                <h3>Epileptische aanval</h3>
            </div>
            <div id="seizure" class="guide-details">
                <p><strong>1.</strong> Verwijder harde of scherpe voorwerpen uit de buurt en plaats iets zachts onder het hoofd.</p>
                <p><strong>2.</strong> Duw niets in de mond; noteer hoe lang de aanval duurt.</p>
                <p><strong>3.</strong> Bel 112 als de aanval langer dan 5 minuten duurt, er verwondingen zijn of het slachtoffer niet wakker wordt.</p>
            </div>
        </div>
        <div class="guide-card" onclick="toggleDetails('diabetes')">
            <div class="card-header">
                <span class="guide-icon">ğŸ¬</span>
                <h3>Diabetes (Hypo/Hyper)</h3>
            </div>
            <div id="diabetes" class="guide-details">
                <p><strong>1.</strong> Herken symptomen: bleekheid, trillen, verwarring kan hypo zijn; dorst, veel plassen kan hyper zijn.</p>
                <p><strong>2.</strong> Bij hypo: geef snelwerkende koolhydraten (snoep, vruchtensap) als het slachtoffer bij bewustzijn is.</p>
                <p><strong>3.</strong> Bij hyper: laat veel water drinken en volg insulineâ€‘/medicatievoorschriften; bij twijfel 112 bellen.</p>
                <p><strong>4.</strong> Bel 112 bij bewustzijnsverlies, ernstige verwarring of als de situatie verslechtert.</p>
            </div>
        </div>
        <div class="guide-card" onclick="toggleDetails('nosebleed')">
            <div class="card-header">
                <span class="guide-icon">ğŸ‘ƒ</span>
                <h3>Bloedneus</h3>
            </div>
            <div id="nosebleed" class="guide-details">
                <p><strong>1.</strong> Laat het slachtoffer rechtop zitten en licht naar voren leunen.</p>
                <p><strong>2.</strong> Knijp de neusvleugels stevig gedurende 10â€‘15 seconden en adem door de mond.</p>
                <p><strong>3.</strong> Herhaal indien nodig; houd het hoofd koel en zoek medische hulp als de bloeding blijft duren.</p>
            </div>
        </div>
        <div class="guide-card" onclick="toggleDetails('eyeforeign')">
            <div class="card-header">
                <span class="guide-icon">ğŸ‘ï¸</span>
                <h3>Vuil in oog</h3>
            </div>
            <div id="eyeforeign" class="guide-details">
                <p><strong>1.</strong> Spoel het oog langzaam met schoon water of een oogdouche, van neus naar buiten.</p>
                <p><strong>2.</strong> Vermijd wrijven; houd het oog open tijdens het spoelen.</p>
                <p><strong>3.</strong> Bel medische hulp bij contact met chemicaliÃ«n of aanhoudende pijn.</p>
            </div>
        </div>
        <div class="guide-card" onclick="toggleDetails('toothinjury')">
            <div class="card-header">
                <span class="guide-icon">ğŸ¦·</span>
                <h3>Tandletsel</h3>
            </div>
            <div id="toothinjury" class="guide-details">
                <p><strong>1.</strong> Bewaar een kapotte of uitgeslagen tand direct in melk of eigen speeksel om uitdrogen te voorkomen.</p>
                <p><strong>2.</strong> Bezoek onmiddellijk de spoedtandarts; neem de tand en een stukje weefsel mee in een gesloten bakje.</p>
            </div>
        </div>
        <div class="guide-card" onclick="toggleDetails('bite')">
            <div class="card-header">
                <span class="guide-icon">ğŸ</span>
                <h3>Insecten- of tekenbeet</h3>
            </div>
            <div id="bite" class="guide-details">
                <p><strong>1.</strong> Verwijder de angel of teek met een steriel pincet; trek recht omhoog zonder te draaien.</p>
                <p><strong>2.</strong> Reinig de plek met water en zeep.</p>
                <p><strong>3.</strong> Observeer op roodheid, zwelling of allergische reactie; bel 112 bij ademhalingsproblemen of koorts.</p>
            </div>
        </div>
        <div class="guide-card" onclick="toggleDetails('electrocution')">
            <div class="card-header">
                <span class="guide-icon">ğŸ”Œ</span>
                <h3>Elektrocutie</h3>
            </div>
            <div id="electrocution" class="guide-details">
                <p><strong>1.</strong> Zet de stroom uit of gebruik een droog, niet-geleidende stok om het slachtoffer los te maken.</p>
                <p><strong>2.</strong> Controleer of het slachtoffer ademt en een hartslag heeft; begin direct met reanimatie als dat nodig is.</p>
                <p><strong>3.</strong> Bel 112 en blijf bij het slachtoffer tot professionele hulp arriveert.</p>
            </div>
        </div>
        <div class="guide-card" onclick="toggleDetails('animalbite')">
            <div class="card-header">
                <span class="guide-icon">ğŸ¾</span>
                <h3>Dierenbeet</h3>
            </div>
            <div id="animalbite" class="guide-details">
                <p><strong>1.</strong> Reinig de wond grondig met water en zeep.</p>
                <p><strong>2.</strong> Bedek met steriel verband en oefen lichte druk uit om bloeding te stoppen.</p>
                <p><strong>3.</strong> Ga naar een arts voor tetanuspreventie en om rabiÃ«srisico te beoordelen.</p>
            </div>
        </div>
        <div class="guide-card" onclick="toggleDetails('vomit')">
            <div class="card-header">
                <span class="guide-icon">ğŸ¤®</span>
                <h3>Hevig braken / Diarree</h3>
            </div>
            <div id="vomit" class="guide-details">
                <p><strong>1.</strong> Geef kleine, frequente slokjes water of orale rehydratatieoplossing (ORS).</p>
                <p><strong>2.</strong> Houd de persoon warm en rust bieden.</p>
                <p><strong>3.</strong> Bel 112 als er bloed in braaksel of ontlasting zit, als braken onophoudelijk doorgaat of bij tekenen van ernstige uitdroging.</p>
            </div>
        </div>
        <div class="guide-card" onclick="toggleDetails('headinjury')">
            <div class="card-header">
                <span class="guide-icon">ğŸ¤•</span>
                <h3>Hoofdletsel (Hersenschudding)</h3>
            </div>
            <div id="headinjury" class="guide-details">
                <p><strong>1.</strong> Laat het slachtoffer rustig liggen en zorg dat hij niet verder beweegt.</p>
                <p><strong>2.</strong> Controleer elke 30 minuten zijn alertheid, pupillen en ademhaling.</p>
                <p><strong>3.</strong> Bel 112 als hij bewusteloos raakt, misselijk wordt of verward raakt.</p>
            </div>
        </div>
        <div class="guide-card" onclick="toggleDetails('hyperventilation')">
            <div class="card-header">
                <span class="guide-icon">ğŸˆ</span>
                <h3>Hyperventilatie</h3>
            </div>
            <div id="hyperventilation" class="guide-details">
                <p><strong>1.</strong> Vraag het slachtoffer rustig te zitten en adem rustig uit in een papieren zak of met beide handen voor de mond.</p>
                <p><strong>2.</strong> Stimuleer langzaam en diep ademen totdat de ademhaling normaliseert.</p>
                <p><strong>3.</strong> CreÃ«er een rustige omgeving; bel 112 als hij het bewustzijn verliest.</p>
            </div>
        </div>
        <div class="guide-card" onclick="toggleDetails('poisonplant')">
            <div class="card-header">
                <span class="guide-icon">ğŸ„</span>
                <h3>Giftige planten</h3>
            </div>
            <div id="poisonplant" class="guide-details">
                <p><strong>1.</strong> Spoel de huid grondig met water en zeep zonder te wrijven.</p>
                <p><strong>2.</strong> Verwijder zoveel mogelijk plantresten voorzichtig.</p>
                <p><strong>3.</strong> Bij inname of ernstige reactie bel 112 of het antigifcentrum; neem label of plantmonster mee.</p>
            </div>
        </div>
        <div class="guide-card" onclick="toggleDetails('panic')">
            <div class="card-header">
                <span class="guide-icon">ğŸ†˜</span>
                <h3>Paniekaanval</h3>
            </div>
            <div id="panic" class="guide-details">
                <p><strong>1.</strong> Blijf rustig en praat zacht, geef geruststelling dat het tijdelijk is.</p>
                <p><strong>2.</strong> Laat hen langzaam en diep ademhalen; leid de aandacht af met oefeningen of tellen.</p>
                <p><strong>3.</strong> Bel professionele hulp als de symptomen niet verminderen of gevaar ontstaat.</p>
            </div>
        </div>
        <div class="guide-card" onclick="toggleDetails('splinter')">
            <div class="card-header">
                <span class="guide-icon">ğŸ¤</span>
                <h3>Splinter of doorn</h3>
            </div>
            <div id="splinter" class="guide-details">
                <p><strong>1.</strong> Was uw handen en het gebied grondig met water en zeep.</p>
                <p><strong>2.</strong> Gebruik een steriel pincet om de splinter langzaam en recht omhoog te trekken.</p>
                <p><strong>3.</strong> Reinig de plek nogmaals en laat open; zie een arts als tekenen van infectie verschijnen.</p>
            </div>
        </div>
    </section>
    </section>
</main>

<div class="action-bar">
    <button class="icon-btn" onclick="alert('Info over de app')">â“˜</button>
    <div class="location-box">
        <i>ğŸ“</i>
        Uw locatie<br><strong>Professorslaan 20</strong>
    </div>
    <button class="icon-btn" onclick="toggleFlashlight()">ğŸ”¦
        <span class="icon-label">Zaklamp</span>
    </button>
    <button class="icon-btn" onclick="toggleDarkMode()">ğŸŒ“
        <span class="icon-label">Dark mode</span>
    </button>
</div>

<nav class="bottom-nav">
    <a href="index.html" class="btn-top nav-item"><span>ğŸ </span>Home</a>
    <button class="icon-btn" onclick="toggleFlashlight()">
        <span class="nav-icon">ğŸ”¦</span>
        <span class="nav-text" data-i18n="flashlight">Zaklamp</span>
    </button>
    <button class="icon-btn" onclick="toggleDarkMode()">
        <span class="nav-icon">ğŸŒ“</span>
        <span class="nav-text" data-i18n="darkmode">Dark mode</span>
    </button>
    <a href="kaart.html" class="btn-top nav-item"><span>ğŸ—ºï¸</span>AED Kaart</a>
    <button class="btn-top nav-item" onclick="openProfilePanel()"><span>ğŸ‘¤</span>Mijn Gegevens</button>
</nav>

<!-- profielpaneel -->
<div id="profile-panel" class="profile-panel" aria-hidden="true">
    <div class="panel-header">
        <h2>Mijn Gegevens</h2>
        <button class="close-btn" onclick="closeProfilePanel()" aria-label="Sluiten">âœ–ï¸</button>
    </div>
    <div class="panel-body">
        <label>Naam
            <input id="profile-name" type="text">
        </label>
        <label>Adres
            <input id="profile-address" type="text">
        </label>
        <label>AllergieÃ«n
            <input id="profile-allergies" type="text">
        </label>
        <label>Bloedgroep
            <input id="profile-blood" type="text">
        </label>
    </div>
</div>


<script>
    function toggleDetails(id) {
        const detail = document.getElementById(id);
        const allDetails = document.querySelectorAll('.guide-details');
        
        // Sluit andere geopende items (optioneel, voor focus)
        allDetails.forEach(item => {
            if(item.id !== id) item.style.display = 'none';
        });

        // Toggle de geselecteerde
        if (detail.style.display === "block") {
            detail.style.display = "none";
        } else {
            detail.style.display = "block";
        }
    }

    let flashlightStream = null;
    let flashlightTrack = null;

    // Herstel dark mode instellingen bij page load
    if (localStorage.getItem('darkMode') === 'true') {
        document.body.classList.add('dark-mode');
    }
    if (localStorage.getItem('flashlight') === 'true') {
        document.body.style.filter = 'invert(1)';
    }

    // Taal en vertalingen
    let currentLang = localStorage.getItem('language') || 'nl';
    const translations = {
        nl:{train:'Trainen',call112:'ğŸ“ 112',home:'Home',flashlight:'Zaklamp',darkmode:'Donker',aedmap:'AED Kaart',infoTitle:'Noodhulp App â€” versie 1.0',infoBody:'Gebruik deze app voor EHBO snelhulp en navigatie.',search_placeholder:'Wat is er aan de hand? (bijv. \'brandwond\')'},
        en:{train:'Training',call112:'ğŸ“ 112',home:'Home',flashlight:'Flashlight',darkmode:'Dark mode',aedmap:'AED Map',infoTitle:'Emergency App â€” v1.0',infoBody:'Use this app for quick first aid and navigation.',search_placeholder:'What is happening? (e.g. \"burn\")'},
        de:{train:'Training',call112:'ğŸ“ 112',home:'Start',flashlight:'Taschenlampe',darkmode:'Nachtmodus',aedmap:'AED Karte',infoTitle:'Notfall-App â€” v1.0',infoBody:'Verwenden Sie diese App fÃ¼r Erste Hilfe und Navigation.',search_placeholder:'Was ist los? (z. B. \"Brandwunde\")'},
        fr:{train:'EntraÃ®nement',call112:'ğŸ“ 112',home:'Accueil',flashlight:'Lampe de poche',darkmode:'Mode sombre',aedmap:'Carte AED',infoTitle:'Application dâ€™urgence â€” v1.0',infoBody:'Utilisez cette application pour les premiers secours et la navigation.',search_placeholder:'Que se passe-t-ilÂ ? (p. ex. \"brÃ»lure\")'},
        es:{train:'Entrenamiento',call112:'ğŸ“ 112',home:'Inicio',flashlight:'Linterna',darkmode:'Modo oscuro',aedmap:'Mapa AED',infoTitle:'App de emergencia â€” v1.0',infoBody:'Usa esta app para primeros auxilios y navegaciÃ³n.',search_placeholder:'Â¿QuÃ© estÃ¡ pasando? (p.ej. \"quemadura\")'}
    };
    function applyTranslations(lang){
        const map=translations[lang]||translations['nl'];
        document.documentElement.lang=lang;
        document.querySelectorAll('[data-i18n]').forEach(el=>{
            const key=el.getAttribute('data-i18n');
            if(map[key]) {
                if(el.tagName === 'INPUT' && 'placeholder' in el) {
                    el.placeholder = map[key];
                } else {
                    el.textContent = map[key];
                }
            }
        });
    }
    const savedLang = localStorage.getItem('language') || currentLang;
    currentLang = savedLang;
    applyTranslations(currentLang);
    window.addEventListener('load', function(){
        const langSelect=document.getElementById('languageSelect');
        if(langSelect) langSelect.value=currentLang;
    });
    function changeLanguage(code){
        localStorage.setItem('language', code);
        currentLang = code;
        applyTranslations(code);
    }
    function showInfo(){
        const map = translations[currentLang] || translations['nl'];
        alert(map.infoTitle+"\n"+map.infoBody);
    }

    function toggleDarkMode() { 
        document.body.classList.toggle("dark-mode");
        localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
    }
    
    async function toggleFlashlight() { 
        try {
            if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                alert('Zaklamp niet ondersteund op deze browser.');
                return;
            }

            if (flashlightTrack) {
                try {
                    await flashlightTrack.applyConstraints({ advanced: [{ torch: false }] });
                    flashlightTrack.stop();
                    flashlightStream.getTracks().forEach(track => track.stop());
                    flashlightTrack = null;
                    flashlightStream = null;
                } catch (e) {
                    console.error('Error turning off flashlight:', e);
                }
                return;
            }

            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: {
                        facingMode: 'environment',
                        advanced: [{ torch: true }]
                    }
                });
                flashlightStream = stream;
                flashlightTrack = stream.getVideoTracks()[0];
            } catch (e) {
                console.log('Trying alternative method for flashlight...');
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: { facingMode: 'environment' }
                });
                const track = stream.getVideoTracks()[0];
                const capabilities = track.getCapabilities ? track.getCapabilities() : {};
                if (capabilities.torch) {
                    try {
                        await track.applyConstraints({ advanced: [{ torch: true }] });
                        flashlightStream = stream;
                        flashlightTrack = track;
                    } catch (constraintErr) {
                        track.stop();
                        stream.getTracks().forEach(t => t.stop());
                        alert('Zaklamp kan niet worden ingeschakeld op dit apparaat.');
                        return;
                    }
                } else {
                    track.stop();
                    stream.getTracks().forEach(t => t.stop());
                    alert('Zaklamp niet beschikbaar op dit apparaat.');
                    return;
                }
            }
        } catch (error) {
            console.error('Zaklamp fout:', error);
            if (error.name === 'NotAllowedError') {
                alert('Zaklamp toestemming geweigerd. Zet dit in je instellingen aan.');
            } else if (error.name === 'NotFoundError') {
                alert('Camera niet gevonden op dit apparaat.');
            } else {
                alert('Kan de zaklamp niet inschakelen. Mogelijke oorzaken: geen camera, geen toestemming, of onvoldoende Android versie (minimaal Android 5).');
            }
        }
    }

    // favorieten functionaliteit voor gids
    function loadFavorites() {
        const fav = localStorage.getItem('favorites');
        return fav ? JSON.parse(fav) : [];
    }

    function saveFavorites(favs) {
        localStorage.setItem('favorites', JSON.stringify(favs));
    }

    function isFavorite(id) {
        return loadFavorites().includes(id);
    }

    function toggleFavorite(id) {
        let favs = loadFavorites();
        if (favs.includes(id)) {
            favs = favs.filter(x => x !== id);
        } else {
            favs.push(id);
        }
        saveFavorites(favs);
        updateFavoriteIcon(id);
        reorderGuides();
    }

    function updateFavoriteIcon(id) {
        const card = document.querySelector(`.guide-card[data-guide="${id}"]`);
        const icon = card && card.querySelector('.favorite-icon');
        if (!icon) return;
        icon.textContent = isFavorite(id) ? 'â˜…' : 'â˜†';
    }

    function reorderGuides() {
        const grid = document.querySelector('.guide-grid');
        if (!grid) return;
        const cards = Array.from(grid.querySelectorAll('.guide-card'));
        const favs = loadFavorites();
        cards.sort((a, b) => {
            const aFav = favs.includes(a.dataset.guide) ? 0 : 1;
            const bFav = favs.includes(b.dataset.guide) ? 0 : 1;
            return aFav - bFav;
        });
        cards.forEach(c => grid.appendChild(c));
    }

    function initFavorites() {
        const cards = document.querySelectorAll('.guide-card');
        cards.forEach(card => {
            let id;
            const onclick = card.getAttribute('onclick');
            if (onclick) {
                const match = onclick.match(/toggleDetails\('([^']+)'\)/);
                if (match) id = match[1];
            }
            if (!id) return;
            card.dataset.guide = id;
            const header = card.querySelector('.card-header');
            const fav = document.createElement('span');
            fav.className = 'favorite-icon';
            fav.textContent = isFavorite(id) ? 'â˜…' : 'â˜†';
            fav.title = 'Favoriet';
            fav.style.cursor = 'pointer';
            fav.addEventListener('click', e => {
                e.stopPropagation();
                toggleFavorite(id);
            });
            header.appendChild(fav);
        });
        reorderGuides();
    }

    // --- profiel panel scripts ---
    function openProfilePanel() {
        document.getElementById('profile-panel').classList.add('open');
    }

    function closeProfilePanel() {
        document.getElementById('profile-panel').classList.remove('open');
    }

    function loadProfile() {
        const data = JSON.parse(localStorage.getItem('profile') || '{}');
        document.getElementById('profile-name').value = data.name || '';
        document.getElementById('profile-address').value = data.address || '';
        document.getElementById('profile-allergies').value = data.allergies || '';
        document.getElementById('profile-blood').value = data.blood || '';
    }

    function saveProfile() {
        const data = {
            name: document.getElementById('profile-name').value,
            address: document.getElementById('profile-address').value,
            allergies: document.getElementById('profile-allergies').value,
            blood: document.getElementById('profile-blood').value
        };
        localStorage.setItem('profile', JSON.stringify(data));
    }
    // zoekfunctie filtert de kaarten op basis van zoekterm
    document.addEventListener('DOMContentLoaded', function() {
        const searchInput = document.querySelector('.search-bar');
        const cards = document.querySelectorAll('.guide-card');

        searchInput.addEventListener('input', function() {
            const query = searchInput.value.trim().toLowerCase();

            cards.forEach(card => {
                const text = card.textContent.toLowerCase();
                if (text.includes(query)) {
                    card.style.display = '';
                } else {
                    card.style.display = 'none';
                }
            });
        });

        // initialiseer favorieten na het opbouwen van de kaarten
        if (typeof initFavorites === 'function') {
            initFavorites();
        }
        // laad eventuele opgeslagen profielgegevens
        if (typeof loadProfile === 'function') {
            loadProfile();
            const inputs = document.querySelectorAll('#profile-panel input');
            inputs.forEach(i => i.addEventListener('input', saveProfile));
        }
    });
</script>
</body>
</html>